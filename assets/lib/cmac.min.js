/*
 * The MIT License
 *
 * (MIT)Copyright (c) 2015 artjomb
 */
!function(t){var r;r=t.hasOwnProperty("ext")?t.ext:t.ext={},r.bitshift=function(t,r){var e,s,n=0,o=t.words,i=0;if(r>0){for(;r>31;)o.splice(0,1),o.push(0),r-=32,i++;if(0==r)return n;for(var a=o.length-i-1;a>=0;a--)e=o[a],o[a]<<=r,o[a]|=n,n=e>>>32-r}else if(0>r){for(;-31>r;)o.splice(0,0,0),o.length--,r+=32,i++;if(0==r)return n;r=-r,s=(1<<r)-1;for(var a=i;a<o.length;a++)e=o[a]&s,o[a]>>>=r,o[a]|=n,n=e<<32-r}return n},r.neg=function(t){for(var r=t.words,e=0;e<r.length;e++)r[e]=~r[e];return t},r.xor=function(t,r){for(var e=0;e<t.words.length;e++)t.words[e]^=r.words[e];return t},r.bitand=function(t,r){for(var e=t.clone(),s=e.words,n=r.words,o=0;o<s.length;o++)s[o]&=n[o];return e}}(CryptoJS),function(t){var r;r=t.hasOwnProperty("ext")?t.ext:t.ext={};{var e=(t.lib.Base,t.lib.WordArray);t.algo.AES}r.const_Zero=e.create([0,0,0,0]),r.const_One=e.create([0,0,0,1]),r.const_Rb=e.create([0,0,0,135]),r.const_Rb_Shifted=e.create([2147483648,0,0,67]),r.const_nonMSB=e.create([4294967295,4294967295,2147483647,2147483647]),r.isWordArray=function(t){return t&&"function"==typeof t.clamp&&"function"==typeof t.concat&&"array"==typeof t.words},t.pad.OneZeroPadding={pad:function(t,r){for(var s=4*r,n=s-t.sigBytes%s,o=[],i=0;n>i;i+=4){var a=0;0===i&&(a=2147483648),o.push(a)}var c=e.create(o,n);t.concat(c)},unpad:function(){}},t.pad.NoPadding={pad:function(){},unpad:function(){}},r.leftmostBytes=function(t,r){var e=t.clone();return e.sigBytes=r,e.clamp(),e},r.rightmostBytes=function(t,e){t.clamp();var s=32,n=t.clone(),o=8*(n.sigBytes-e);if(o>=s){var i=Math.floor(o/s);o-=i*s,n.words.splice(0,i),n.sigBytes-=i*s/8}return o>0&&(r.bitshift(n,o),n.sigBytes-=o/8),n},r.popWords=function(t,e){var s=r.leftmostBytes(t,4*e);return t.words=t.words.slice(e),t.sigBytes-=4*e,s},r.shiftBytes=function(t,s){s=s||16;var n=s%4;s-=n;for(var o=e.create(),i=0;s>i;i+=4)o.words.push(t.words.shift()),t.sigBytes-=4,o.sigBytes+=4;return n>0&&(o.words.push(t.words[0]),o.sigBytes+=n,r.bitshift(t,8*n),t.sigBytes-=n),o},r.xorendBytes=function(t,e){return r.leftmostBytes(t,t.sigBytes-e.sigBytes).concat(r.xor(r.rightmostBytes(t,e.sigBytes),e))},r.dbl=function(t){var e=r.msb(t);return r.bitshift(t,1),r.xor(t,1===e?r.const_Rb:r.const_Zero),t},r.inv=function(t){var e=1&t.words[4];return r.bitshift(t,-1),r.xor(t,1===e?r.const_Rb_Shifted:r.const_Zero),t},r.equals=function(t,r){if(!r||!r.words||t.sigBytes!==r.sigBytes)return!1;t.clamp(),r.clamp();for(var e=0,s=0;s<t.words.length;s++)e|=t.words[s]^r.words[s];return 0===e},r.msb=function(t){return t.words[0]>>>31}}(CryptoJS),function(t){function r(r,e){var o=n.createEncryptor(r,{iv:s.create(),padding:t.pad.NoPadding}),i=o.finalize(e);return i}var e=t.lib.Base,s=t.lib.WordArray,n=t.algo.AES,o=t.ext,i=t.pad.OneZeroPadding,a=t.algo.CMAC=e.extend({init:function(t){var e=r(t,o.const_Zero),s=e.clone();if(o.dbl(s),this._isTwo){var n=e.clone();o.inv(n)}else{var n=s.clone();o.dbl(n)}this._K1=s,this._K2=n,this._K=t,this._const_Bsize=16,this.reset()},reset:function(){this._x=o.const_Zero.clone(),this._counter=0,this._buffer=s.create()},update:function(e){if(!e)return this;var s=this._buffer,n=this._const_Bsize;for("string"==typeof e&&(e=t.enc.Utf8.parse(e)),s.concat(e);s.sigBytes>n;){var i=o.shiftBytes(s,n);o.xor(this._x,i),this._x.clamp(),this._x=r(this._K,this._x),this._counter++}return this},finalize:function(t){this.update(t);var e=this._buffer,s=this._const_Bsize,n=e.clone();return e.sigBytes===s?o.xor(n,this._K1):(i.pad(n,s/4),o.xor(n,this._K2)),o.xor(n,this._x),this.reset(),r(this._K,n)},_isTwo:!1});t.CMAC=function(t,r){return a.create(t).finalize(r)},t.algo.OMAC1=a,t.algo.OMAC2=a.extend({_isTwo:!0})}(CryptoJS);